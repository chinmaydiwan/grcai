(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[680],{5098:(e,t,s)=>{Promise.resolve().then(s.bind(s,9586))},9586:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>c});var r=s(5155),a=s(2115),l=s(680),n=s(2099);function c(){let[e,t]=(0,a.useState)([]),[s,c]=(0,a.useState)(null),[d,o]=(0,a.useState)([]),[x,m]=(0,a.useState)(!0);async function h(){try{let{data:e,error:s}=await n.N.from("compliance_frameworks").select("*").order("name");if(s)throw s;t(e||[]),m(!1)}catch(e){console.error("Error fetching frameworks:",e),m(!1)}}async function u(e){try{let{data:t,error:s}=await n.N.from("controls").select("*").eq("framework_id",e).order("control_id");if(s)throw s;o(t||[])}catch(e){console.error("Error fetching controls:",e)}}return(0,a.useEffect)(()=>{h()},[]),(0,a.useEffect)(()=>{s&&u(s)},[s]),(0,r.jsx)(l.A,{children:(0,r.jsxs)("div",{className:"space-y-6",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsx)("h2",{className:"text-2xl font-bold text-gray-900",children:"Compliance Management"}),(0,r.jsx)("button",{type:"button",className:"rounded-md bg-blue-600 px-4 py-2 text-sm font-medium text-white hover:bg-blue-700",children:"Add Framework"})]}),x?(0,r.jsx)("div",{children:"Loading frameworks..."}):(0,r.jsxs)("div",{className:"grid grid-cols-1 gap-6 lg:grid-cols-4",children:[(0,r.jsxs)("div",{className:"col-span-1 space-y-4",children:[(0,r.jsx)("h3",{className:"text-lg font-medium text-gray-900",children:"Frameworks"}),(0,r.jsx)("div",{className:"space-y-2",children:e.map(e=>(0,r.jsxs)("button",{onClick:()=>c(e.id),className:"w-full rounded-lg px-4 py-2 text-left ".concat(s===e.id?"bg-blue-100 text-blue-700":"bg-white text-gray-700 hover:bg-gray-50"),children:[(0,r.jsx)("div",{className:"font-medium",children:e.name}),(0,r.jsxs)("div",{className:"text-sm text-gray-500",children:["v",e.version]})]},e.id))})]}),(0,r.jsx)("div",{className:"col-span-3",children:s?(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsx)("h3",{className:"text-lg font-medium text-gray-900",children:"Controls"}),(0,r.jsx)("button",{type:"button",className:"rounded-md bg-blue-600 px-4 py-2 text-sm font-medium text-white hover:bg-blue-700",children:"Add Control"})]}),(0,r.jsx)("div",{className:"overflow-hidden rounded-lg bg-white shadow",children:(0,r.jsxs)("table",{className:"min-w-full divide-y divide-gray-200",children:[(0,r.jsx)("thead",{className:"bg-gray-50",children:(0,r.jsxs)("tr",{children:[(0,r.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium uppercase tracking-wider text-gray-500",children:"Control ID"}),(0,r.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium uppercase tracking-wider text-gray-500",children:"Title"}),(0,r.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium uppercase tracking-wider text-gray-500",children:"Status"}),(0,r.jsx)("th",{className:"relative px-6 py-3",children:(0,r.jsx)("span",{className:"sr-only",children:"Actions"})})]})}),(0,r.jsx)("tbody",{className:"divide-y divide-gray-200 bg-white",children:d.map(e=>(0,r.jsxs)("tr",{children:[(0,r.jsx)("td",{className:"whitespace-nowrap px-6 py-4 text-sm font-medium text-gray-900",children:e.control_id}),(0,r.jsx)("td",{className:"px-6 py-4 text-sm text-gray-500",children:e.title}),(0,r.jsx)("td",{className:"whitespace-nowrap px-6 py-4",children:(0,r.jsx)(i,{controlId:e.id})}),(0,r.jsx)("td",{className:"whitespace-nowrap px-6 py-4 text-right text-sm font-medium",children:(0,r.jsx)("button",{className:"text-blue-600 hover:text-blue-900",children:"Assess"})})]},e.id))})]})})]}):(0,r.jsx)("div",{className:"flex h-full items-center justify-center rounded-lg border-2 border-dashed border-gray-300 p-12 text-center",children:(0,r.jsx)("div",{className:"space-y-2",children:(0,r.jsx)("div",{className:"text-sm text-gray-500",children:"Select a framework to view its controls"})})})})]})]})})}function i(e){let{controlId:t}=e,[s,l]=(0,a.useState)(null);(0,a.useEffect)(()=>{!async function(){try{var e;let{data:s,error:r}=await n.N.from("control_assessments").select("status").eq("control_id",t).order("assessment_date",{ascending:!1}).limit(1);if(r)throw r;l((null==s||null==(e=s[0])?void 0:e.status)||"not_implemented")}catch(e){console.error("Error fetching control status:",e)}}()},[t]);let{bg:c,text:i}={effective:{bg:"green-100",text:"green-800"},partially_effective:{bg:"yellow-100",text:"yellow-800"},ineffective:{bg:"red-100",text:"red-800"},not_implemented:{bg:"gray-100",text:"gray-800"}}[s||"not_implemented"];return(0,r.jsx)("span",{className:"inline-flex items-center rounded-full bg-".concat(c," px-2.5 py-0.5 text-xs font-medium text-").concat(i),children:(null==s?void 0:s.replace("_"," ").toUpperCase())||"NOT IMPLEMENTED"})}}},e=>{var t=t=>e(e.s=t);e.O(0,[606,299,441,684,358],()=>t(5098)),_N_E=e.O()}]);